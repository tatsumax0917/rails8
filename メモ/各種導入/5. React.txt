※前提:node, yarnを使えるようにしておく


・railsでreactを扱えるようにする
yarn add react react-dom


・railsのcontrollerを作成（Rails 側の MVC は1つだけあれば十分）
rails g controller home index


・config/routes.rb を編集
root 'home#index'


・view/layout/application.html.erb
<body>
  <div id="root"></div> ←追加
  <%= yield %>
</body>


・app/javascript/application.jsをapplication.jsxに変更

import React from 'react';
import { createRoot } from 'react-dom/client';

function App() {
  return (
    <h1>Hello React!</h1>
  )
}

const root = document.getElementById('root');
if (!root) {
  throw new Error('No root element');
}
createRoot(root).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);


・app/views/home/index.html.erbの中身は空に


===================================
[package.json]
"scripts": {
  "build:js": "esbuild app/javascript/*.* --bundle --sourcemap --format=esm --outdir=app/assets/builds --public-path=/assets --loader:.jsx=jsx --watch",
  "build": "yarn build:js" ←herokuなどではbuildで認識するらしいから結局build:js実行してるけどまぁ一応
},

[Procfile.dev]
web: bin/rails server -b 0.0.0.0 -p 3000
js: yarn build:js
(※--watchはpackage.jsonのscriptでするのが本来らしい)



=======Tips========
プロジェクトルートに
[jsconfig.json]作って

{
  "compilerOptions": {
    "baseUrl": "app/javascript",  // ルートディレクトリを指定
    "paths": {
      "@/*": ["*"]  // "@"をapp/javascriptのエイリアスとして設定
    }
  }
}

とすると'@/components/Hello'みたいに読み込める
@はbaseUrl